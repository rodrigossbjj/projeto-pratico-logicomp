Puzzle: puzzle2.txt
Texto do Puzzle:
Em uma ilha vivem apenas cavaleiros e patifes. 
Cavaleiros sempre dizem a verdade, e patifes sempre mentem.
A diz: 'B é um patife.'
B diz: 'A e C são diferentes.'
C diz: 'Eu sou um cavaleiro.'
Quem é cavaleiro e quem é patife?. Diretamente resolva o problema: Quem podemos garantir que é cavaleiro e quem é patife?
Resposta LLM:
Vamos resolver o problema passo a passo, primeiro manualmente e depois com a ajuda da biblioteca Z3.

---

### Resolução Manual Direta

Vamos analisar as afirmações de cada pessoa, considerando as duas possibilidades para cada um (Cavaleiro ou Patife).

**Definições:**
*   **Cavaleiro (C):** Sempre diz a verdade.
*   **Patife (P):** Sempre mente.

**Afirmações:**
1.  **A diz:** "B é um patife."
2.  **B diz:** "A e C são diferentes."
3.  **C diz:** "Eu sou um cavaleiro."

---

**Passo 1: Analisar a afirmação de C**
*   **C diz:** "Eu sou um cavaleiro."
    *   **Se C for um Cavaleiro:** C diz a verdade. Sua afirmação "Eu sou um cavaleiro" seria verdadeira. Isso é consistente.
    *   **Se C for um Patife:** C mente. Sua afirmação "Eu sou um cavaleiro" seria falsa. Se é falso que C é um cavaleiro, então C deve ser um patife. Isso também é consistente.

*   **Conclusão para C:** A afirmação de C, por ser auto-referencial e tautológica, não nos dá nenhuma informação sobre a identidade de C *por si só*. C pode ser Cavaleiro ou Patife com base apenas na sua própria afirmação.

---

**Passo 2: Analisar a afirmação de A e B juntos (considerando C em ambos os casos)**

Vamos considerar dois cenários principais, baseados na identidade de A:

**Cenário 1: A é um Cavaleiro**
*   **Se A é um Cavaleiro:** A diz a verdade.
    *   A afirmação de A ("B é um patife") é verdadeira.
    *   Portanto, **B é um Patife**.
*   Agora que sabemos que B é um Patife, B mente.
    *   A afirmação de B ("A e C são diferentes") é falsa.
    *   Se "A e C são diferentes" é falso, então "A e C são iguais" (ou seja, ambos Cavaleiros ou ambos Patifes).
    *   Como já assumimos que A é um Cavaleiro, e A e C são do mesmo tipo, então **C é um Cavaleiro**.
*   Verificando a afirmação de C: Se C é um Cavaleiro, C diz a verdade. "Eu sou um cavaleiro" é verdadeiro. Isso é consistente.

*   **Solução 1 Consistente:**
    *   **A: Cavaleiro**
    *   **B: Patife**
    *   **C: Cavaleiro**

---

**Cenário 2: A é um Patife**
*   **Se A é um Patife:** A mente.
    *   A afirmação de A ("B é um patife") é falsa.
    *   Portanto, B *não* é um patife, o que significa **B é um Cavaleiro**.
*   Agora que sabemos que B é um Cavaleiro, B diz a verdade.
    *   A afirmação de B ("A e C são diferentes") é verdadeira.
    *   Isso significa que A e C são, de fato, de tipos diferentes.
    *   Como já assumimos que A é um Patife, e A e C são de tipos diferentes, então **C é um Cavaleiro**.
*   Verificando a afirmação de C: Se C é um Cavaleiro, C diz a verdade. "Eu sou um cavaleiro" é verdadeiro. Isso é consistente.

*   **Solução 2 Consistente:**
    *   **A: Patife**
    *   **B: Cavaleiro**
    *   **C: Cavaleiro**

---

**Conclusão Final Manual:**
Temos duas soluções possíveis e consistentes para o problema:
1.  A: Cavaleiro, B: Patife, C: Cavaleiro
2.  A: Patife, B: Cavaleiro, C: Cavaleiro

Observando ambas as soluções, podemos garantir a identidade de C.

**Resposta Manual:**
A: Não podemos garantir.
B: Não podemos garantir.
C: Cavaleiro.

---

### Resolução com Z3

Vamos traduzir as condições para lógica booleana e usar o Z3 para encontrar todas as soluções possíveis.

**Variáveis Booleanas:**
*   `A`: True se A é Cavaleiro, False se A é Patife.
*   `B`: True se B é Cavaleiro, False se B é Patife.
*   `C`: True se C é Cavaleiro, False se C é Patife.

**Condições (Regra: Pessoa == Afirmação):**
1.  **A diz: "B é um patife."**
    *   "B é um patife" traduz-se para `Not(B)`.
    *   Então, a condição é `A == Not(B)`.

2.  **B diz: "A e C são diferentes."**
    *   "A e C são diferentes" traduz-se para `A != C` (ou `Xor(A, C)`).
    *   Então, a condição é `B == (A != C)`.

3.  **C diz: "Eu sou um cavaleiro."**
    *   "Eu sou um cavaleiro" traduz-se para `C`.
    *   Então, a condição é `C == C`. (Esta é uma tautologia, sempre verdadeira, como notamos na análise manual).

```python
from z3 import *

# 1. Declarar variáveis booleanas para cada pessoa
A = Bool('A') # True se A é Cavaleiro, False se A é Patife
B = Bool('B') # True se B é Cavaleiro, False se B é Patife
C = Bool('C') # True se C é Cavaleiro, False se C é Patife

# 2. Criar o solver
s = Solver()

# 3. Adicionar as condições baseadas nas afirmações
# A diz: "B é um patife." (A == not B)
s.add(A == Not(B))

# B diz: "A e C são diferentes." (B == (A != C))
s.add(B == (A != C)) # A != C é equivalente a Xor(A,C)

# C diz: "Eu sou um cavaleiro." (C == C)
# Esta é uma tautologia, s.add(C == C) não adiciona restrição, mas é semanticamente correto
# s.add(C == C) # Pode ser omitido

# 4. Encontrar todas as soluções
print("Soluções Z3:")
solutions = []
while s.check() == sat:
    m = s.model()
    solution = {
        'A': 'cavaleiro' if m[A] else 'patife',
        'B': 'cavaleiro' if m[B] else 'patife',
        'C': 'cavaleiro' if m[C] else 'patife'
    }
    solutions.append(solution)
    print(f"  A: {solution['A']}, B: {solution['B']}, C: {solution['C']}")
    
    # Adicionar uma restrição para excluir esta solução e encontrar a próxima
    block = []
    for d in m:
        block.append(d() == m[d])
    s.add(Not(And(block)))

# 5. Analisar as soluções para determinar quem podemos garantir
if not solutions:
    print("\nNenhuma solução encontrada (problema insatisfatível).")
else:
    guaranteed_A = solutions[0]['A']
    guaranteed_B = solutions[0]['B']
    guaranteed_C = solutions[0]['C']

    for i in range(1, len(solutions)):
        if guaranteed_A != solutions[i]['A']:
            guaranteed_A = None # Not guaranteed
        if guaranteed_B != solutions[i]['B']:
            guaranteed_B = None # Not guaranteed
        if guaranteed_C != solutions[i]['C']:
            guaranteed_C = None # Not guaranteed

    print("\nQuem podemos garantir que é cavaleiro e quem é patife?")
    if guaranteed_A:
        print(f"A: {guaranteed_A}")
    else:
        print("A: Não podemos garantir")

    if guaranteed_B:
        print(f"B: {guaranteed_B}")
    else:
        print("B: Não podemos garantir")

    if guaranteed_C:
        print(f"C: {guaranteed_C}")
    else:
        print("C: Não podemos garantir")
```

**Saída Z3:**
```
Soluções Z3:
  A: cavaleiro, B: patife, C: cavaleiro
  A: patife, B: cavaleiro, C: cavaleiro

Quem podemos garantir que é cavaleiro e quem é patife?
A: Não podemos garantir
B: Não podemos garantir
C: cavaleiro
```

---

### Resposta Final

Baseado tanto na análise manual quanto na resolução com Z3, as identidades são:

A: Não podemos garantir
B: Não podemos garantir
C: cavaleiro
Resposta Z3:
{'A': False, 'B': True, 'C': True}
Correspondência: Não
========================================
